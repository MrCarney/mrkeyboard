units:
  u: U
  $default_width: cx
  $default_height: cy
  $default_autobind: 11
  thumb_radius: ((5cx/2+1)^2 + (5cy/2)^2)^0.5
  phi: atan((5cy/2)/(5cx/2+1)) - pi/6
  thumb_2high_hypotenuse: ((cx/2)^2 + (3cy/2)^2)^0.5
points:
  key:
    bind: [1,0]
    padding: cy
    spread: cx
    rotate: 0
    tags:
      1high: true
  zones:
    board:
      columns:
        far:
          key:
            column_net: P16
          rows:
            arrows:
              bind: [12,0]
            bottom:
              bind: [7,0]
              shift: [-0.25cx,0]
              tags:
                1high: false
                15high: true
            home:
              bind: [7,0]
              tags:
                1high: false
                15high: true
            top:
              bind: [7,0]
              tags:
                1high: false
                15high: true
            number:
              bind: [7,4]
              tags:
                1high: false
                15high: true
        pinkie:
          key:
            column_net: P14
          rows:
            number:
              bind: [1,4]
        ring:
          key:
            column_net: P15
            stagger: 2
          rows:
            arrows:
              bind: [1,2]
            number:
              bind: [1,2]
        middle:
          key:
            column_net: P18
            stagger: 2
          rows:
            arrows:
              bind: [1,4]
        index:
          key:
            column_net: P19
            stagger: -2
          rows:
            arrows:
              bind: [1,2]
            number:
              bind: [1,2]
        indexplus:
          key:
            column_net: P20
            stagger: -2
          rows:
            arrows.skip: true
            bottom:
              bind: [0,5]
            home:
            top:
            number:
              bind: [1,4]
        inside:
          key:
            column_net: P21
            stagger: -2
          rows:
            arrows.skip: true
            bottom.skip: true
            home:
              bind: [42.75,14.2]
            top:
              bind: [42.75,6]
            number:
              bind: [42.75,6]
      rows:
        arrows:
          row_net: P6
        bottom:
          row_net: P5
        home:
          row_net: P4
        top:
          row_net: P3
        number:
          row_net: P2
    thumb:
      anchor:
        ref: board_indexplus_arrows
        shift: [0,-cy-1]
        rotate: -30
      columns:
        tc1:
          key:
            column_net: P20
          rows:
            tr1:
              tags:
                2high: true
              shift: [0,0.5cy]
            tr2.skip: true
            tr3.skip: true
        tc2:
          key:
            column_net: P21
          rows:
            tr1:
              tags:
                2high: true
              shift: [0,0.5cy]
            tr2.skip: true
            tr3:
              shift: [0,-0.5cy]
        tc3:
          key:
            column_net: P10
          rows:
            tr1:
              bind: [1.1,0]
            tr2:
              bind: [1,14]
      rows:
        tr1:
          row_net: P6
        tr2:
          row_net: P5
        tr3:
          row_net: P4
outlines:
  polygon:
    - what: polygon
      points:
        - ref: board_far_number
          shift: [-1.5cx/2-1,cy/2+4+1]
        - ref: board_far_arrows
          shift: [-1.5cx/2-1-0.25cx,-cy/2-1]
        - ref: board_far_arrows
          shift: [4cx,-cy/2-1]
        - ref: thumb_tc1_tr1
        - ref: board_indexplus_home
          shift: [thumb_radius*cos(phi),-3cy + thumb_radius*sin(phi)-1]
        - ref: board_pinkie_number
          shift: [4cx+thumb_radius*cos(phi),cy/2+4+1]
    - what: polygon
      points:
        - ref: thumb_tc3_tr1
          shift: [-4cx,-cy/2-1]
        - ref: thumb_tc3_tr1
          shift: [cx/2+1,-cy/2-1]
        - ref: thumb_tc3_tr3
          shift: [cx/2+1,cy/2]
        - ref: thumb_tc3_tr3
          shift: [-4cx,cy/2+1]
  roundedpoly:
    - what: outline
      name: polygon
      fillet: 3
  keycap_outlines:
    - what: rectangle
      size: [1cx - 0.5, 1cy - 0.5] # Choc keycaps are 17.5 x 16.5
      bound: false
      where: 1high
  keycap_outlines15:
    - what: rectangle
      size: [1.5cx - 0.5, 1cy - 0.5] # Choc keycaps are 17.5 x 16.5
      bound: false
      where: 15high
  keycap_outlines20:
    - what: rectangle
      size: [1cx - 0.5, 2cy - 0.5] # Choc keycaps are 17.5 x 16.5
      bound: false
      where: 2high
  preview:
    - name: keycap_outlines
    - name: keycap_outlines15
    - name: keycap_outlines20
pcbs:
  mrkeyboard:
    outlines:
      board:
        outline: roundedpoly
      keycaps:
        outline: preview
        layer: Eco1.User
    footprints:
      choc_hotswap:
        what: choc
        params:
          keycaps: false
          reverse: true
          hotswap: true
          from: =column_net
          to: =colrow
        where: true
        adjust:
          rotate: 180
      diode:
        what: diode
        params:
          from: =colrow
          to: =row_net
        where: true
        adjust:
          shift: [-8, 3.5]
          rotate: 270
      rgb:
        what: rgb
        params:
          din: P1
          dout: D1
          VCC: VCC
          GND: GND
        where: true
        adjust:
          shift: [0, 4.7]
      promicro:
        what: promicro_pretty
        where:
          ref: board_inside_number
          shift: [27,-4]
          rotate: -90
      reset:
        what: button
        where:
          ref:
            - board_inside_home
          shift: [cx/2+10, 2.25]
          rotate: 90
        params:
          from: RST
          to: GND
      reset2:
        what: button
        where:
          ref:
            - board_inside_home
          shift: [cx/2+10, 2.25]
          rotate: 90
        params:
          from: RST
          to: GND
          side: B
      trrs:
        what: trrs
        where:
          ref: board_inside_home
          shift: [41, 0]
          rotate: -90
        params:
          A: GND
          B: GND
          C: P9
          D: VCC
          reverse: true
          symmetric: true
